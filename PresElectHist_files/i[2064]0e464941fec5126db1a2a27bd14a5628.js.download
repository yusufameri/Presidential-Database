jQuery(document).ready(function(){jQuery('div.ajax-newsletter').each(function(){if(jQuery('form',this).length==0)return;var container=this,signups=0;jQuery('input[type="button"]',container).bind('click',function(){if(jQuery(container).data('getJSON')===true)return;var email=jQuery('input[name="email"]',container).val(),failed=!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(email);jQuery('label[for="email"]',container).css('color',(failed?'red':''));if(!failed){jQuery(container).data('getJSON',true);jQuery.getJSON('/ajax/newsletter.php',{action:'signup',email:email,source:jQuery('input[name="source"]',container).val()},function(data){if(data&&data.success){++signups;jQuery('form',container).fadeOut(function(){jQuery('label',container).text('Signup a'+(signups>1?'nother':'')+' friend:');jQuery('input[name="email"]',container).val('');jQuery('input[name="signup-submit"]',container).val('Add My Friend!');jQuery('p:first,form',container).show()})}else jQuery('label[for="email"]',container).css('color','red');container=null})}})})});(function(){var c=new Object();c.toggle=function(){if($(this).hasClass('exempt'))return true;this.blur();var a=jQuery(this).find('span.indicator'),b=jQuery(this.parentNode).find('div:eq(0)');a.html((a.html()=='+'?'-':'+'));b.css('display',(a.html()=='+'?'none':'block'));a=null;b=null;return false};c.init=function(){jQuery('#navigation-left .expando').each(function(){jQuery(this).find('.expander').bind('click',c.toggle)})};jQuery(document).ready(c.init)}())